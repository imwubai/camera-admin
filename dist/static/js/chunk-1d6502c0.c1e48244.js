(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d6502c0"],{"5db8":function(t,e,a){"use strict";var s=a("9337"),o=a.n(s);o.a},9337:function(t,e,a){},a434:function(t,e,a){"use strict";var s=a("23e7"),o=a("23cb"),i=a("a691"),n=a("50c4"),r=a("7b0b"),c=a("65f0"),l=a("8418"),d=a("1dde"),g=a("ae40"),u=d("splice"),m=g("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,f=Math.min,p=9007199254740991,b="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!u||!m},{splice:function(t,e){var a,s,d,g,u,m,v=r(this),P=n(v.length),S=o(t,P),y=arguments.length;if(0===y?a=s=0:1===y?(a=0,s=P-S):(a=y-2,s=f(h(i(e),0),P-S)),P+a-s>p)throw TypeError(b);for(d=c(v,s),g=0;g<s;g++)u=S+g,u in v&&l(d,g,v[u]);if(d.length=s,a<s){for(g=S;g<P-s;g++)u=g+s,m=g+a,u in v?v[m]=v[u]:delete v[m];for(g=P;g>P-s+a;g--)delete v[g-1]}else if(a>s)for(g=P-s;g>S;g--)u=g+s-1,m=g+a-1,u in v?v[m]=v[u]:delete v[m];for(g=0;g<a;g++)v[g+S]=arguments[g+2];return v.length=P-s+a,d}})},b822:function(t,e,a){},cb4b:function(t,e,a){"use strict";var s=a("b822"),o=a.n(s);o.a},dc42:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"路口名称"}},[a("el-input",{attrs:{placeholder:"请设置路口名称"},model:{value:t.form.crossingName,callback:function(e){t.$set(t.form,"crossingName",e)},expression:"form.crossingName"}})],1)],1)],1),a("el-row",[a("el-form-item",{attrs:{label:"已选择路口方位"}},t._l(t.selectedRoadArray,(function(e,s){return a("div",{key:e.crossingPointName,staticClass:"selectedRoad"},[t._v(t._s(e.crossingPointName)),a("i",{staticClass:"selectedRoadClear el-icon-circle-close",on:{click:function(e){return t.removeSelectedRoad(s)}}})])})),0)],1)],1),a("el-form",{ref:"form",staticClass:"roadposition_form",attrs:{model:t.searchform,"label-width":"120px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"路口方位"}},[a("el-input",{attrs:{placeholder:"请输入路口方位查找"},model:{value:t.searchform.crossingPointName,callback:function(e){t.$set(t.searchform,"crossingPointName",e)},expression:"searchform.crossingPointName"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",loading:t.listLoading},on:{click:t.onSearch}},[t._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"600px"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{key:e.row.crossingPointId,staticClass:"selectRow-checkbox",attrs:{checked:(t.multipleSelection[e.row.crossingPointId]||{}).value||!1},on:{change:function(a){return t.handleSelectionChange(a,e.row)}}})]}}])}),a("el-table-column",{attrs:{prop:"crossingPointName",label:"路口方位"}}),a("el-table-column",{attrs:{prop:"crossingPointStatus",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[2===e.row.crossingPointStatus?a("div",[t._v("启用")]):t._e(),1===e.row.crossingPointStatus?a("div",[t._v("禁用")]):t._e(),3===e.row.crossingPointStatus?a("div",[t._v("维修")]):t._e()]}}])})],1),a("div",{staticClass:"table_pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.paginationTotal,"page-size":10},on:{"current-change":t.currentChange}})],1),a("div",{staticClass:"savebtn"},[a("el-button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:t.doSubmit}},[t._v("设置路口完成")])],1)],1)},o=[],i=(a("4160"),a("d81d"),a("a434"),a("159b"),a("5530")),n=a("b775"),r={data:function(){return{crossingId:null,listLoading:!1,currentPage:1,paginationTotal:0,tableData:[],saveLoading:!1,multipleSelection:{},selectedRoadArray:[],form:{crossingName:""},searchform:{},searchData:{}}},mounted:function(){var t=this,e=this.$route.query,a=e.crossingId,s=e.crossingPointName,o=e.crossingPointId;this.getTableData(1),a?n["a"].get("/api/crossings/".concat(a)).then((function(e){var a=e.data,s=a.crossingName,o=a.crossingId,i=a.crossingPointData;t.crossingId=o,t.form.crossingName=s,i&&i.length>0&&(t.selectedRoadArray=i,i.forEach((function(e){t.multipleSelection[e.crossingPointId]={value:!0,crossingPointId:e.crossingPointId,crossingPointName:e.crossingPointName}})))})).catch((function(e){t.$message.error(e.response.data.returnMessage||"获取数据异常")})):s&&(this.selectedRoadArray=[{crossingPointId:o,crossingPointName:s}],this.multipleSelection[o]={value:!0,crossingPointId:o,crossingPointName:s})},methods:{getTableData:function(t){var e=this;this.listLoading=!0,n["a"].post("/api/crossingpoints/search",Object(i["a"])({pageNo:t,pageSize:10,type:2},this.searchData)).then((function(t){e.listLoading=!1,e.tableData=t.data.data,e.paginationTotal=t.data.totalCount})).catch((function(t){e.listLoading=!1,e.$message({message:"获取数据异常",type:"error"})}))},currentChange:function(t){this.getTableData(t)},onSearch:function(){this.searchData=this.searchform,this.getTableData(1)},handleSelectionChange:function(t,e){for(var a in this.multipleSelection[e.crossingPointId]||(this.multipleSelection[e.crossingPointId]={}),Object.assign(this.multipleSelection[e.crossingPointId],Object(i["a"])({value:t},e)),this.selectedRoadArray=[],this.multipleSelection){var s=this.multipleSelection[a]||{},o=s.crossingPointId,n=s.crossingPointName,r=s.value;r&&this.selectedRoadArray.push({crossingPointId:o,crossingPointName:n})}},removeSelectedRoad:function(t){var e=this,a=this.selectedRoadArray[t].crossingPointId;this.selectedRoadArray.splice(t,1),this.multipleSelection[a].value=!1;var s=this.tableData;this.tableData=[],setTimeout((function(){e.tableData=s}))},doSubmit:function(){var t=this,e=this.form.crossingName;if(e)if(this.selectedRoadArray.length<=0)this.$message.error("请先选择路口方位");else{var a=this.selectedRoadArray.map((function(t){var e=t.crossingPointId;return e})),s={};s=this.crossingId?{crossingId:this.crossingId,crossingPointId:a}:{crossingName:e,crossingPointId:a},this.saveLoading=!0,n["a"].post("/api/crossing",s).then((function(e){t.saveLoading=!1,t.$message({message:"操作成功",type:"success",duration:1e3,onClose:function(){location.reload()}}),console.log(e)})).catch((function(e){t.saveLoading=!1,t.$message.error(e.response.data.returnMessage||"操作失败")}))}else this.$message.error("请先输入路口名称")}}},c=r,l=(a("5db8"),a("cb4b"),a("2877")),d=Object(l["a"])(c,s,o,!1,null,"6c253358",null);e["default"]=d.exports}}]);